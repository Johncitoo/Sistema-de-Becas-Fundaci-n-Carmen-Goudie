# Configuración de Gitleaks para detección de secretos
title = "Gitleaks Configuration"

[extend]
useDefault = true

[[rules]]
id = "generic-api-key"
description = "Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret)['"`:=\s]+[a-z0-9_-]{20,}'''
tags = ["key", "API"]

[[rules]]
id = "jwt-token"
description = "JWT Token"
regex = '''eyJ[A-Za-z0-9-_=]+\.eyJ[A-Za-z0-9-_=]+\.[A-Za-z0-9-_.+/=]+'''
tags = ["key", "JWT"]

[[rules]]
id = "database-connection"
description = "Database Connection String"
regex = '''(?i)(mongodb|mysql|postgres|postgresql|redis)://[^\s]+'''
tags = ["key", "Database"]

[[rules]]
id = "private-key"
description = "Private Key"
regex = '''-----BEGIN (RSA|DSA|EC|OPENSSH|PGP) PRIVATE KEY-----'''
tags = ["key", "private"]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS"]

[allowlist]
description = "Allowlist"
paths = [
    '''node_modules/''',
    '''.git/''',
    '''package-lock.json'''
]
